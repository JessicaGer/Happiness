---
title: "Happiness Score"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)

library(sf)
library(tidyverse)
library(ggiraph)
```
 
```{r message=FALSE, warning=FALSE, paged.print=FALSE}
#Map laden
#https://tapiquen-sig.jimdofree.com/english-version/free-downloads/europe/
map_europe <- sf::read_sf("shapefiles")

happyscore <- read.csv2("./datasets/Happiness_Score_Countries.csv")

reisenhappiness <- read.csv2("./datasets/happiness_reisen.csv")

#Happiness Score Datensatz laden
happyscore_EU <- filter(happyscore, name %in% c("Germany", "France",  "United Kingdom", "Spain", "Italy", "Poland", "Sweden", "Netherlands", "Finland", "Czech Republic", "Norway", "Austria", "Switzerland", "Hungary", "Denmark", "Romania", "Portugal", "Belgium", "Ireland", "Slovakia", "Greece", "Estonia", "Croatia", "Slovenia", "Bulgaria", "Lithuania", "Latvia", "Cyprus", "Luxembourg", "Malta", "Russia", "Turkey", "Ukraine", "Kazakhstan", "Azerbaijan", "Belarus", "Serbia", "Moldova", "Georgia", "Bosnia And Herzegovina", "Armenia", "Albania", "Latvia", "Montenegro", "Iceland", "Andorra", "Faroe Islands", "Monaco", "Liechtenstein", "San Marino", "Vatican City"))

  #Nur Europa & nur 2018
  happyscore_EU_2018 <- filter(happyscore_EU, year == 2018)

```
### Wie glücklich ist Europa?
Der sogenannte "Happiness Score" gibt die Lebenszufriedenheit eines Landes in Prozent an. Unsere interaktive Karte zeigt dir durch farbliche Markierungen an, wie glücklich die Menschen sind. Je höher der Happiness Score, desto glücklicher sind die Menschen. 
Wenn du mehr über den Happiness Score erfahren möchtest, klicke [$\color{#A8DCEE}{hier!}$](https://worldhappiness.report/archive/)
Wenn du mit der Maus über die Karte fährst, erfährst du, um welches Land es sich jeweils handelt. Was die Karte noch so kann, das zeigen wir dir gleich. Also bleib gespannt!

```{r message=FALSE, warning=FALSE, paged.print=FALSE, layout="l-body-outset", fig.width=100, fig.height=120}

map_europe %>%
  mutate(jscode = glue::glue('window.open("{NAME}.html")')) %>%
  left_join(happyscore_EU_2018, by = c("NAME" = "name")) %>% ggplot() +
  aes(fill = happiness.score) +
  geom_sf_interactive(aes(tooltip = NAME, 
                          onclick = jscode)) +
  scale_fill_viridis_c() +
  theme_void() +
  labs (title = "Lebenszufriedenheit in Europa 2018 (in %)", 
        subtitle = "Interaktive Karte von Europa",
        fill = "Happiness Score (%)") -> happiness_map

ggiraph::girafe(
  ggobj = happiness_map, pointsize = 18, width_svg = 10, height_svg = 10*0.618)
```
Unser Lollipop-Diagramm stellt eine andere Art der Visualisierung des Happiness Scores dar. Es soll dir dabei helfen, dich noch näher mit dem Happiness Score auseinander zu setzen. 

```{r message=FALSE, warning=FALSE, paged.print=FALSE, layout="l-body-outset", fig.width=8, fig.height=8}
# Lolipop Chart Happiness Score und Land 

ggplot(reisenhappiness, aes(x = fct_reorder(Land, whr), y = whr, color = whr))+ 
  geom_point( size= 5, alpha = 0.8) +  
  geom_line()+
  geom_segment(aes(x = Land, xend= Land, y=0, yend= whr)) +
  scale_color_viridis_c()+ 
  coord_flip() +
  theme_light() + 
    theme(panel.grid.major.y = element_blank(),panel.border = element_blank(), axis.ticks.y = element_blank()) +
  geom_text(aes(label = whr), size =3, hjust = -0.6, color = "black") +
  labs(title = "Happiness Score in Europa nach Ländern",
       subtitle = "Im Jahr 2018 (%) ",
       caption = "Quelle: Gapminder",
       x = "Land",
       y = "Happiness Score (%)")
```
Hättest du gedacht, dass Finnland das glücklichste Land Europas ist? Wieso sind die Menschen in Finnland glücklicher als wir? Wie du dir bestimmt denken kannst, gibt es viele Faktoren, die dabei eine wichtige Rolle spielen. Wir möchten dir auf unserer Seite einen Grund davon zeigen: $\color{#A8DCEE}{REISEN}$

Eine neue Studie aus dem Jahr 2021 belegt: $\color{#A8DCEE}{Reisen}$ $\color{#A8DCEE}{macht}$ $\color{#A8DCEE}{glücklich!}$ Überzeuge dich selbst davon, indem du dich mit unseren Grafiken zum Einfluss des Reisens auf den Happiness Score beschäftigst. 
Möchtest du mehr über die Studie erfahren? Dann klicke [$\color{#A8DCEE}{hier!}$](https://www.ingentaconnect.com/content/cog/ta/2021/00000026/00000001/art00006;jsessionid=6i07c83eni86b.x-ic-live-01)

```{r message=FALSE, warning=FALSE, paged.print=FALSE, layout="l-body-outset", fig.width=8, fig.height=8}
ggplot(happiness_reisen, aes(y= fct_reorder(Land, reisen.person), x= reisen.person, color = whr )) + 
  geom_point(size= 6, alpha = 0.8)+ 
  scale_color_viridis_c() + 
  geom_text(aes(label = reisen.person), size=3, hjust = -0.7, color = "black") + 
  theme_light() + 
  labs (x = "Anzahl der Reisen p.P. pro Jahr",
        y = "Land",
      title = "Anzahl der Reisen der Länder Europas nach Happiness Score", 
      subtitle = "Streudiagramm",
      color = "Happiness 
Score (%)")
```
Wie du siehst, reisen die Finnen im Durchschnitt am häufigsten.  

Deutschland belegt den Platz 12 bei den häufigsten Reisen in Europa